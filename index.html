<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Control System - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./assets/icons/favicon.ico">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/components.css">
    <link rel="stylesheet" href="./css/responsive.css">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="./js/main.js" as="script" crossorigin="anonymous">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-spinner"></div>
        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏∞‡∏ö‡∏ö Visual Control...</p>
    </div>

    <div class="container">
        <!-- Header Section -->
        <header class="header">
            <div class="header-content">
                <h1>üéØ Visual Control System</h1>
                <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏µ‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡πà‡∏≠‡∏á</p>
                <div class="version-info">v1.0.0</div>
            </div>
        </header>
        
        <!-- Camera Controls (ADD) -->
        <div class="flex items-center gap-2">
        <label for="cameraSelect" class="text-sm opacity-80">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á:</label>
        <select id="cameraSelect" class="px-2 py-1 rounded-md bg-gray-800 border border-gray-600 text-sm min-w-[260px]">
        <option value="">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏•‡πâ‡∏≠‡∏á‚Ä¶</option>
        </select>
        <button id="refreshCamerasBtn" class="px-3 py-1 rounded-md bg-gray-700 hover:bg-gray-600 text-sm">
        ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠
        </button>
        </div>

        <!-- Status Bar -->
        <section class="status-bar">
            <div id="cameraStatus" class="status-item status-disconnected">
                <span class="status-icon">üìπ</span>
                <span class="status-text">‡∏Å‡∏•‡πâ‡∏≠‡∏á: ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
            </div>
            <div id="bluetoothStatus" class="status-item status-disconnected">
                <span class="status-icon">üîä</span>
                <span class="status-text">‡∏•‡∏≥‡πÇ‡∏û‡∏á: ‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</span>
            </div>
            <div id="monitoringStatus" class="status-item status-disconnected">
                <span class="status-icon">üëÅÔ∏è</span>
                <span class="status-text">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</span>
            </div>
        </section>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Video Section -->
            <section class="video-section">
                <div class="section-header">
                    <h3>üìπ ‡∏†‡∏≤‡∏û‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡πâ‡∏≠‡∏á</h3>
                    <div class="video-controls-header">
                        <button id="fullscreenBtn" class="btn btn-sm btn-secondary" title="‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠">
                            üì∫
                        </button>
                    </div>
                </div>
                
                <div class="video-container" id="videoContainer">
                    <video id="videoElement" autoplay muted playsinline></video>
                    <canvas id="overlayCanvas" class="reference-overlay"></canvas>
                    
                    <!-- Video Info Overlay -->
                    <div class="video-info">
                        <span id="videoResolution">-</span>
                        <span id="frameRate">- FPS</span>
                    </div>
                </div>
                
                <div class="video-controls">
                    <button id="startCamera" class="btn btn-primary">
                        üé• ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
                    </button>
                    <button id="takeReference" class="btn btn-success" disabled>
                        üì∏ ‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
                    </button>
                    <button id="clearReference" class="btn btn-warning" disabled>
                        üóëÔ∏è ‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
                    </button>
                    <button id="saveReference" class="btn btn-info" disabled>
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏†‡∏≤‡∏û‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á
                    </button>
                </div>
            </section>

            <!-- Controls Section -->
            <section class="controls-section">
                <!-- Connection Controls -->
                <div class="control-group">
                    <h3>üîä ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏™‡∏µ‡∏¢‡∏á</h3>
                    <div class="bluetooth-section">
                        <button id="connectBluetooth" class="btn btn-primary">
                            üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡∏≥‡πÇ‡∏û‡∏á
                        </button>
                        <button id="disconnectBluetooth" class="btn btn-danger" disabled>
                            üîå ‡πÄ‡∏•‡∏¥‡∏Å‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                        </button>
                        <button id="testSound" class="btn btn-warning" disabled>
                            üîä ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á
                        </button>
                        <div id="bluetoothInfo" class="connection-info hidden">
                            <span class="connection-status">‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡∏≥‡πÇ‡∏û‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</span>
                        </div>
                    </div>
                </div>

                <!-- Sensitivity Settings -->
                <div class="control-group">
                    <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏ß</h3>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label for="rotationSensitivity">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏≠‡∏µ‡∏¢‡∏á (‡∏≠‡∏á‡∏®‡∏≤)</label>
                            <div class="slider-container">
                                <input type="range" id="rotationSensitivity" class="slider" 
                                       min="1" max="15" value="5" step="1">
                                <span class="slider-value" id="rotationValue">5¬∞</span>
                            </div>
                        </div>
                        
                        <div class="setting-item">
                            <label for="positionSensitivity">‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á (‡∏û‡∏¥‡∏Å‡πÄ‡∏ã‡∏•)</label>
                            <div class="slider-container">
                                <input type="range" id="positionSensitivity" class="slider" 
                                       min="5" max="100" value="20" step="5">
                                <span class="slider-value" id="positionValue">20px</span>
                            </div>
                        </div>

                        <div class="setting-item">
                            <label for="detectionThreshold">‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏à‡∏±‡∏ö (%)</label>
                            <div class="slider-container">
                                <input type="range" id="detectionThreshold" class="slider" 
                                       min="10" max="90" value="50" step="10">
                                <span class="slider-value" id="thresholdValue">50%</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Monitoring Controls -->
                <div class="control-group">
                    <h3>üéõÔ∏è ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏£‡∏∞‡∏ö‡∏ö</h3>
                    <div class="monitoring-controls">
                        <button id="startMonitoring" class="btn btn-success btn-large" disabled>
                            ‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
                        </button>
                        <button id="stopMonitoring" class="btn btn-danger btn-large" disabled>
                            ‚èπÔ∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
                        </button>
                        <button id="pauseAlert" class="btn btn-warning" disabled>
                            üîá ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô 30 ‡∏ß‡∏¥
                        </button>
                        <button id="resetStats" class="btn btn-secondary">
                            üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Statistics Section -->
        <section class="statistics-section">
            <h3>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h3>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üì¶</div>
                    <div class="stat-content">
                        <div id="totalBoxes" class="stat-number">0</div>
                        <div class="stat-label">‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                    </div>
                </div>
                
                <div class="stat-card stat-success">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-content">
                        <div id="normalBoxes" class="stat-number">0</div>
                        <div class="stat-label">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</div>
                    </div>
                </div>
                
                <div class="stat-card stat-danger">
                    <div class="stat-icon">‚ö†Ô∏è</div>
                    <div class="stat-content">
                        <div id="alertBoxes" class="stat-number">0</div>
                        <div class="stat-label">‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥</div>
                    </div>
                </div>
                
                <div class="stat-card stat-info">
                    <div class="stat-icon">üéØ</div>
                    <div class="stat-content">
                        <div id="accuracy" class="stat-number">100%</div>
                        <div class="stat-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Alert Section -->
        <section class="alert-section">
            <div id="systemAlert" class="alert-box alert-info">
                <span class="alert-icon">‚ÑπÔ∏è</span>
                <span class="alert-message">‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô - ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á</span>
            </div>
        </section>
    </div>

    <!-- Scripts -->
    <script type="module" src="./js/main.js"></script>
    
    <!-- Service Worker for PWA (optional) -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
    <!-- Emergency loading screen hide -->
    <script>
        // Force hide loading screen after 5 seconds if still visible
        setTimeout(() => {
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen && !loadingScreen.classList.contains('hidden')) {
                console.warn('‚ö†Ô∏è Emergency: Forcing loading screen to hide');
                loadingScreen.style.display = 'none';
            }
        }, 5000);
    </script>
</body>
</html>